;; ---------------------------------------------------------------------------
;; Integration: 1Password
;; 1Password desktop app and CLI agent socket access.
;; Source: 50-integrations-core/1password.sb
;; ---------------------------------------------------------------------------

(allow file-read* file-write*
    (home-subpath "/.config/op")                               ;; 1Password CLI (op) config and session tokens.
)

(allow mach-lookup
    (global-name-regex #"^([A-Z0-9]+\\.)?com\\.1password\\.")  ;; 1Password app/service IPC endpoints.
    (global-name-regex #"^com\\.agilebits\\.")                 ;; Legacy AgileBits service names still used by some installs.
)
