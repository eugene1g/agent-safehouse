;; ---------------------------------------------------------------------------
;; Integration: Spotlight
;; Spotlight search via mdfind/mdls/mdutil for filesystem indexing.
;; Source: 50-integrations/spotlight.sb
;; ---------------------------------------------------------------------------

(allow file-read* file-write*
    (subpath "/private/var/db/mds")                    ;; Spotlight metadata store; also hosts se_SecurityMessages used by keychain.
)

(allow mach-lookup
    (global-name "com.apple.metadata.mds")             ;; Primary Spotlight metadata server used by mdfind/mdls queries.
    (global-name "com.apple.metadata.mds.legacy")      ;; Legacy Spotlight query interface still used by some tools.
    (global-name "com.apple.PowerManagement.control")  ;; Power state queries used by spotlightknowledged helper.
)
