;; ---------------------------------------------------------------------------
;; Local Overrides
;; #safehouse-test-id:local-overrides# Local deny rules (defense-in-depth).
;; Final deny rules for defense-in-depth; uncomment blocks to restrict sensitive paths.
;; Source: 99-local-overrides.sb
;; ---------------------------------------------------------------------------

;; Uncomment blocks below to deny access to sensitive paths.

;; (deny file-read* file-write*
;;     (home-subpath "/.aws")         ;; Block AWS credential reads and tampering.
;;     (data-home-subpath "/.aws")    ;; Same deny for macOS Data volume path aliases.
;; )

;; (deny file-read* file-write*
;;     (home-subpath "/server/secret")
;;     (home-subpath "/server/certs")
;; )

;; Optional hardening: block AppleScript execution.
;; Use if you do not want sandboxed tools triggering GUI automation/notifications via osascript.
;; (deny process-exec
;;     (literal "/usr/bin/osascript")
;; )

;; Local-only read allowances.
(allow file-read*
    (home-literal "/RepoPrompt/repoprompt_cli")  ;; Allow local helper binary probe used by Cursor integration.
    (subpath "/Applications/Repo Prompt.app")    ;; Allow app-bundle metadata reads for local helper detection.
    (home-literal "/.gitignore_global")          ;; Global gitignore used by git across all repositories.
    (home-subpath "/ssh-identities")             ;; Local SSH identity files for git/ssh connectivity.
    (home-subpath "/.orbstack")                  ;; OrbStack config/state for container/VM integration.
    (home-subpath "/Library/Application Support/CleanShot/media")      ;; CleanShot media library for local screenshot workflows.
    (data-home-subpath "/Library/Application Support/CleanShot/media") ;; Same allow for macOS Data volume path aliases.
)
